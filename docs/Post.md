# Post - 合同

Post是由各资源/设施Manager负责创建和发布的任务信息，由PostManager负责管理和维护

Post记录一份工作的相关信息，如：参与对象id和对象类型的字典，任务状态

Post有固有字段和特有字段，即不同的工作除了基本信息外会有各自需要记录的信息

>### 约定 - 合同结构
>
>`id`				合同id
>
>`entreisId`		合同签署人id列表，用于存档和恢复运行时环境
>
>`entreisName`	合同签署人Name列表，用于存档和恢复运行时环境
>
>`postType`		合同种类，用以区分不同工作内容的合同
>
>`bodyNeed`		签署这个合同至少需要什么“种类”的部件，注意是种类，不需要标注数量
>
>`status`			合同状态
>
>`options`		不同合同需要附加的特殊字段，必须是字面量或者属性是字面量的对象



## 任务
Post目前只包含一个任务，以及任务的具体流程，如采集和运输

Post中每个独立的任务本身会涉及多个状态

Post中每个任务都有“状态转换函数”，意味着每个任务都拥有退出和进入的条件（也可以没有，即退出=新一轮的开始）

每个任务都需要以下几个属性/方法使得creep知道如何执行该任务

1. 状态机
2. 上一个状态，包含状态名和Game.time
3. 当前状态名

## 有限状态机

状态机描述在已知的有限状态下的各种操作，每种任务拥有各自不同的状态机，它包含以下内容:

1. 状态初始化方法: 如果没有在状态寄存器中找到有关的状态的话，就需要将初始化以便能够使用状态转换函数
2. 状态机执行方法: 对当前状态进行处理，会依次处理当前状态的before，do和after方法(也可能跳过do和after)
3. 状态转换函数: 用于判断是否需要转换状态，转换后可以立即执行状态字典中的相关方法
4. 状态字典，它的结构如下:

>### 约定 - 有限状态机结构
>
>```
>{
>	[status name1]: {
>		before:	处在该状态时，在执行该状态对应的具体操作前执行的方法，可用于临时改变状态或其他操作
>		do:		该状态对应的具体操作
>		after:	具体操作执行后的后置方法，有时候需要在执行后判断是否要结束任务或者转换新的状态
>	},
>	[status name2]: {...},
>}
>```
>
